<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!-- OP-DBUS System Bus Configuration -->
  
  <!-- Allow op-dbus user to own our bus names -->
  <policy user="op-dbus">
    <allow own_prefix="org.opdbus"/>
    <allow send_destination="org.opdbus.AgentManager"/>
    <allow send_destination="org.opdbus.Orchestrator"/>
    <allow send_destination="org.opdbus.Introspection"/>
    <allow send_destination="org.opdbus.Chat"/>
  </policy>

  <!-- Allow root to own and send to our services -->
  <policy user="root">
    <allow own_prefix="org.opdbus"/>
    <allow send_destination="org.opdbus.AgentManager"/>
    <allow send_destination="org.opdbus.Orchestrator"/>
    <allow send_destination="org.opdbus.Introspection"/>
    <allow send_destination="org.opdbus.Chat"/>
  </policy>

  <!-- Allow any user to call our methods (for chat interface) -->
  <policy context="default">
    <!-- Agent Manager -->
    <allow send_destination="org.opdbus.AgentManager"
           send_interface="org.opdbus.AgentManager"/>
    <allow send_destination="org.opdbus.AgentManager"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_destination="org.opdbus.AgentManager"
           send_interface="org.freedesktop.DBus.Properties"/>
    
    <!-- Orchestrator -->
    <allow send_destination="org.opdbus.Orchestrator"
           send_interface="org.opdbus.Orchestrator"/>
    <allow send_destination="org.opdbus.Orchestrator"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    <allow send_destination="org.opdbus.Orchestrator"
           send_interface="org.freedesktop.DBus.Properties"/>
    
    <!-- Introspection Service -->
    <allow send_destination="org.opdbus.Introspection"
           send_interface="org.opdbus.Introspection"/>
    <allow send_destination="org.opdbus.Introspection"
           send_interface="org.freedesktop.DBus.Introspectable"/>
    
    <!-- Chat Service -->
    <allow send_destination="org.opdbus.Chat"
           send_interface="org.opdbus.Chat"/>
    <allow send_destination="org.opdbus.Chat"
           send_interface="org.freedesktop.DBus.Introspectable"/>
  </policy>
</busconfig>
